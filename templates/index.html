<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>80天減重計畫</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>80 天減重計畫</h1>
        <p class="subtitle"><span id="startWeight">119</span> kg → <span id="targetWeight">99</span> kg | 目標減重 20 公斤</p>
    </header>

    <nav>
        <button class="nav-btn active" data-tab="overview">總覽</button>
        <button class="nav-btn" data-tab="exercise">每日運動</button>
        <button class="nav-btn" data-tab="weight">體重記錄</button>
    </nav>

    <main>
        <!-- 總覽 -->
        <section id="overview" class="tab-content active">
            <div class="card">
                <h2>營養目標</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="bmrValue">2300</span>
                        <span class="stat-label">基礎代謝 kcal</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="caloriesRange">1800-2200</span>
                        <span class="stat-label">每日攝取 kcal</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="proteinTarget">180-220</span>
                        <span class="stat-label">蛋白質目標 g</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">MARS</span>
                        <span class="stat-label" id="wheyInfo">水解乳清 35g/包</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>階段總覽</h2>
                <table>
                    <thead>
                        <tr>
                            <th>階段</th>
                            <th>天數</th>
                            <th>重點</th>
                            <th>預期減重</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>第一階段</td>
                            <td>Day 1-14</td>
                            <td>適應期：建立習慣</td>
                            <td>2-3 kg</td>
                        </tr>
                        <tr>
                            <td>第二階段</td>
                            <td>Day 15-42</td>
                            <td>燃脂期：穩定執行</td>
                            <td>7-9 kg</td>
                        </tr>
                        <tr>
                            <td>第三階段</td>
                            <td>Day 43-80</td>
                            <td>衝刺期：最大化燃脂</td>
                            <td>15-20 kg</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="card">
                <h2>運動參數（適應期）
                    <button class="btn-add" onclick="showExerciseModal()">+ 新增</button>
                </h2>
                <table>
                    <thead>
                        <tr>
                            <th>運動類型</th>
                            <th>時間</th>
                            <th>速率/強度</th>
                            <th>預估距離</th>
                            <th>預估消耗</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="exerciseTable">
                        <tr><td colspan="6" class="loading">載入中...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 每日運動（翻頁式，一頁七天） -->
        <section id="exercise" class="tab-content">
            <div class="card">
                <div class="week-navigation">
                    <button class="btn-nav" id="prevWeek">&lt; 上一週</button>
                    <span class="week-title" id="weekTitle">第 1 週（Day 1 - 7）</span>
                    <button class="btn-nav" id="nextWeek">下一週 &gt;</button>
                </div>
            </div>

            <div class="week-grid" id="weekGrid">
                <!-- 七天的運動卡片會由 JS 動態生成 -->
            </div>
        </section>

        <!-- 體重記錄 -->
        <section id="weight" class="tab-content">
            <div class="card">
                <h2>體重追蹤</h2>
                <div class="weight-input">
                    <label for="todayWeight">今日體重（kg）：</label>
                    <input type="number" id="todayWeight" step="0.1" min="50" max="200">
                    <button id="saveWeightBtn" class="btn-primary">記錄</button>
                </div>
                <div class="chart-container">
                    <canvas id="weightCanvas"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>統計資料</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value">119</span>
                        <span class="stat-label">起始體重 kg</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="currentWeightVal">--</span>
                        <span class="stat-label">目前體重 kg</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="totalLost">--</span>
                        <span class="stat-label">累計減重 kg</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="targetRemaining">--</span>
                        <span class="stat-label">距離目標 kg</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>體重記錄表</h2>
                <table id="weightTable">
                    <thead>
                        <tr>
                            <th>日期</th>
                            <th>Day</th>
                            <th>體重 (kg)</th>
                            <th>變化</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td colspan="5" class="loading">載入中...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- 運動項目 Modal -->
    <div class="modal" id="exerciseModal">
        <div class="modal-content">
            <h3 id="exerciseModalTitle">新增運動項目</h3>
            <form id="exerciseForm" onsubmit="event.preventDefault(); saveExercise();">
                <input type="hidden" id="exerciseId">
                <div class="form-group">
                    <label>運動類型</label>
                    <input type="text" id="exerciseName" placeholder="例：快走" required>
                </div>
                <div class="form-group">
                    <label>時間</label>
                    <input type="text" id="exerciseDuration" placeholder="例：85 分鐘" required>
                </div>
                <div class="form-group">
                    <label>速率/強度</label>
                    <input type="text" id="exerciseIntensity" placeholder="例：5.5 km/h">
                </div>
                <div class="form-group">
                    <label>預估距離</label>
                    <input type="text" id="exerciseDistance" placeholder="例：約 7.8 km">
                </div>
                <div class="form-group">
                    <label>預估消耗</label>
                    <input type="text" id="exerciseCalories" placeholder="例：550-650 kcal">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeExerciseModal()">取消</button>
                    <button type="submit" class="btn-primary">儲存</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <footer>
        <p>80 天減重計畫 | Flask + SQLite 版本</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
